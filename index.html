<!DOCTYPE html>
<html lang="bn" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ঢাকার স্বর্ণের বাজারের মূল্য তালিকা</title>
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0B0B0F" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] },
          colors: { base: {50:'#f6f7f9',100:'#ECEEF2',900:'#0B0B0F'} },
          boxShadow: { soft:'0 6px 30px rgba(0,0,0,.12)', ring:'inset 0 0 0 1px rgba(255,255,255,.06)'}
        }
      }
    }
  </script>
  <style>
    :root{ --panel: rgba(255,255,255,.06); --border: rgba(255,255,255,.12); }
    .glass{backdrop-filter:saturate(140%) blur(14px)}
    .flash{animation:flashBg .9s ease-out}
    @keyframes flashBg{0%{background:linear-gradient(90deg,rgba(251,191,36,.25),transparent)}100%{background:transparent}}
    @media(prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}

    .container{ max-width:min(1100px,92vw); margin-inline:auto; }
    .table-wrap{ position:relative; overflow:auto; border-radius:14px; border:1px solid var(--border); }
    .table-wrap::after{ content:""; position:absolute; right:0; top:0; bottom:0; width:28px; pointer-events:none; background:linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,.22)); }
    @media (min-width: 640px){ .table-wrap::after{ display:none; } }

    /* Mobile first: card rows */
    @media(max-width:640px){
      table.rtable{ width:100%; border-collapse:separate; border-spacing:0; }
      table.rtable thead{ display:none; }
      table.rtable tbody{ display:block; }
      table.rtable tr{ display:grid; grid-template-columns: 1fr; gap:.35rem; margin:10px 0; padding:.6rem .7rem; background:var(--panel); border:1px solid var(--border); border-radius:14px; box-shadow:0 6px 20px rgba(0,0,0,.14); }
      table.rtable td{ display:flex; justify-content:space-between; align-items:center; padding:.45rem .25rem; }
      table.rtable td::before{ content: attr(data-label); font-weight:600; color:#a3a3a3; margin-right:.75rem; }
      table.rtable td.price{ justify-content:flex-end; font-weight:800; font-size:clamp(16px,5.2vw,22px); color:#facc15; letter-spacing:.2px; }
      table.rtable td[data-label="মূল্য (BDT)"]{ border-top:1px dashed var(--border); padding-top:.6rem; }
    }

    /* Ad banners */
    .ad-banner{ display:flex; align-items:center; justify-content:center; border-radius:16px; background:var(--panel); border:1px dashed var(--border); color:#bbb; text-align:center; margin:12px 0; overflow:hidden; min-height:90px; position:relative }
    .ad-label{ position:absolute; top:6px; right:10px; font-size:10px; letter-spacing:.08em; opacity:.7 }
    @media(max-width:640px){ .ad-banner{ min-height:100px } }

    /* Mobile view switcher (tabs) */
    .tabs{ display:grid; grid-template-columns:repeat(3,1fr); gap:6px; background:rgba(255,255,255,.05); padding:6px; border-radius:999px; border:1px solid var(--border); }
    .tab{ padding:.5rem .8rem; border-radius:999px; text-align:center; font-weight:600; font-size:13px; opacity:.9; }
    .tab.active{ background:linear-gradient(180deg, rgba(251,191,36,.25), rgba(168,85,247,.18)); color:white; }

    /* Hide sections on mobile based on data-view */
    @media(max-width:1023px){
      [data-section]{ display:none; }
      body[data-view="today"] [data-section="today"],
      body[data-view="old"] [data-section="old"],
      body[data-view="new"] [data-section="new"]{ display:block; }
    }
    @media(min-width:1024px){ .tabs{ display:none } }
  </style>
</head>
<body class="bg-base-900 text-gray-100 antialiased selection:bg-amber-400/40" data-view="today">
  <!-- Background -->
  <div class="fixed inset-0 -z-10">
    <div class="absolute inset-0 bg-[radial-gradient(1200px_600px_at_10%_-10%,rgba(251,191,36,.12),transparent),radial-gradient(900px_500px_at_100%_10%,rgba(168,85,247,.10),transparent)]"></div>
  </div>

  <!-- Sticky Topbar -->
  <div class="sticky top-0 z-40 backdrop-blur-xl bg-base-900/80 border-b border-white/10">
    <header class="container px-4 py-3">
      <div class="flex items-center justify-between gap-3">
        <div class="flex items-center gap-3">
          <span class="inline-flex h-2.5 w-2.5 rounded-full bg-amber-400"></span>
          <h1 class="text-[clamp(18px,4.2vw,28px)] font-extrabold tracking-[-0.02em] text-white">স্বর্ণের বাজার মূল্য</h1>
        </div>
        <div class="hidden sm:flex items-center gap-2 text-xs">
          <button id="themeToggle" class="px-3 py-1 rounded-full bg-white/10 hover:bg-white/15 transition">Light / Dark</button>
          <button id="densityToggle" class="px-3 py-1 rounded-full bg-white/10 hover:bg-white/15 transition">Compact</button>
        </div>
      </div>
    </header>
  </div>

  <!-- Hero -->
  <section class="container px-4 pt-6">
    <div class="rounded-2xl p-5 md:p-7 glass shadow-soft shadow-ring border border-white/10 bg-neutral-900/60">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h2 class="text-[clamp(20px,4vw,32px)] font-extrabold leading-tight">আজকের লাইভ স্বর্ণের দাম</h2>
          <p class="text-gray-400 text-sm mt-1">সকল স্ক্রিনে অপ্টিমাইজড · রিয়েলটাইম আপডেট</p>
        </div>
        <div class="w-full md:w-auto">
          <div class="tabs">
            <button class="tab active" data-go="today">আজকের দাম</button>
            <button class="tab" data-go="old">পুরাতন গহনা</button>
            <button class="tab" data-go="new">নতুন গহনা</button>
          </div>
        </div>
      </div>
      <p class="mt-3 text-rose-300/90 text-xs">সর্বশেষ আপডেট: <span id="updatedAtTop">—</span></p>
    </div>
  </section>

  <!-- TOP BANNER AD -->
  <div class="container px-4">
    <div id="ad-top" class="relative ad-banner" data-size="banner" role="complementary" aria-label="Advertisement">
      <span class="ad-label">Ad</span>
      <div id="ad-top-slot" class="py-6 text-xs sm:text-sm">Banner Ad (320×100 / 728×90 / 970×90)</div>
    </div>
  </div>

  <main class="container px-4 pb-24 space-y-8">
    <!-- Section: Today -->
    <section data-section="today" class="p-[1px] rounded-2xl bg-gradient-to-br from-amber-400/35 to-fuchsia-500/25">
      <div class="relative rounded-2xl p-5 md:p-7 bg-neutral-900/70 glass shadow-soft shadow-ring">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-[clamp(16px,3.5vw,20px)] font-semibold">আজকের স্বর্ণের দাম</h3>
          <span id="status1" class="text-xs px-2 py-1 rounded-full bg-neutral-800">Connecting…</span>
        </div>
        <div class="table-wrap">
          <table class="rtable min-w-full text-[15px]" id="tableToday">
            <thead class="bg-amber-500/95 text-black">
              <tr>
                <th class="px-4 py-3 text-left">স্বর্ণ</th>
                <th class="px-4 py-3 text-left">বিবরণ</th>
                <th class="px-4 py-3 text-left">মূল্য (BDT)</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-white/5 bg-neutral-900/30">
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২৪ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি ভরি বিস্কুট (99.99%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_24k_biscuit_bhori">৳ —</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২৪ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি ভরি পাশা স্বর্ণ (99.50%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_24k_pasha_bhori">৳ —</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২৪ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি গ্রাম বিস্কুট (99.99%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_24k_biscuit_gram">৳ —</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="mt-3 text-rose-300/90 text-xs">সর্বশেষ আপডেট: <span id="updatedAt1">—</span></p>
      </div>
    </section>

    <!-- MID BANNER AD -->
    <div id="ad-mid" class="relative ad-banner" data-size="banner" role="complementary" aria-label="Advertisement">
      <span class="ad-label">Ad</span>
      <div id="ad-mid-slot" class="py-6 text-xs sm:text-sm">Banner Ad (320×100 / 728×90 / 970×90)</div>
    </div>

    <!-- Section: Old -->
    <section data-section="old" class="p-[1px] rounded-2xl bg-gradient-to-br from-amber-400/30 to-fuchsia-500/18">
      <div class="relative rounded-2xl p-5 md:p-7 bg-neutral-900/70 glass shadow-soft shadow-ring">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-[clamp(16px,3.5vw,20px)] font-semibold">পুরাতন গহনা ক্রয় বিক্রয়</h3>
        </div>
        <div class="table-wrap">
          <table class="rtable min-w-full text-[15px]" id="tableOld">
            <thead class="bg-amber-500/95 text-black">
              <tr>
                <th class="px-4 py-3 text-left">স্বর্ণ</th>
                <th class="px-4 py-3 text-left">বিবরণ</th>
                <th class="px-4 py-3 text-left">মূল্য (BDT)</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-white/5 bg-neutral-900/30">
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২২ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি ভরি গহনা (91.67%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_old_22k_bhori">৳ —</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২১ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি ভরি গহনা (87.50%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_old_21k_bhori">৳ —</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২২ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি গ্রাম গহনা (91.67%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_old_22k_gram">৳ —</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="স্বর্ণ">২১ ক্যারেট</td>
                <td class="px-4 py-3" data-label="বিবরণ">প্রতি গ্রাম গহনা (87.50%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_old_21k_gram">৳ —</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="mt-3 text-rose-300/90 text-xs">সর্বশেষ আপডেট: <span id="updatedAtOld">—</span></p>
      </div>
    </section>

    <!-- Section: New -->
    <section data-section="new" class="p-[1px] rounded-2xl bg-gradient-to-br from-amber-400/22 to-fuchsia-500/12">
      <div class="relative rounded-2xl p-5 md:p-7 bg-neutral-900/70 glass shadow-soft shadow-ring">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-[clamp(16px,3.5vw,20px)] font-semibold">নতুন গহনা ক্রয়</h3>
          <span id="status2" class="text-xs px-2 py-1 rounded-full bg-neutral-800">Connecting…</span>
        </div>
        <div class="table-wrap">
          <table class="rtable min-w-full text-[15px]" id="tableNew">
            <thead class="bg-amber-500/95 text-black">
              <tr>
                <th class="px-4 py-3 text-left">নতুন গহনা ক্রয়</th>
                <th class="px-4 py-3 text-left">বিবরণ</th>
                <th class="px-4 py-3 text-left">মূল্য (BDT)</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-white/5 bg-neutral-900/30">
              <tr>
                <td class="px-4 py-3" data-label="নতুন গহনা ক্রয়">২২ ক্যারেট প্রতি ভরি</td>
                <td class="px-4 py-3" data-label="বিবরণ">গহনা (৯১.৬৭%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_new_22k_bhori">৳ —</span> <span class="text-xs opacity-70">/ ভরি</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="নতুন গহনা ক্রয়">২১ ক্যারেট প্রতি ভরি</td>
                <td class="px-4 py-3" data-label="বিবরণ">গহনা (৮৭.৫০%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_new_21k_bhori">৳ —</span> <span class="text-xs opacity-70">/ ভরি</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="নতুন গহনা ক্রয়">২২ ক্যারেট প্রতি গ্রাম</td>
                <td class="px-4 py-3" data-label="বিবরণ">গহনা (৯১.৬৭%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_new_22k_gram">৳ —</span> <span class="text-xs opacity-70">/ গ্রাম</span></td>
              </tr>
              <tr>
                <td class="px-4 py-3" data-label="নতুন গহনা ক্রয়">২১ ক্যারেট প্রতি গ্রাম</td>
                <td class="px-4 py-3" data-label="বিবরণ">গহনা (৮৭.৫০%)</td>
                <td class="px-4 py-3 price" data-label="মূল্য (BDT)"><span data-key="price_new_21k_gram">৳ —</span> <span class="text-xs opacity-70">/ গ্রাম</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="mt-3 text-rose-300/90 text-xs">সর্বশেষ আপডেট: <span id="updatedAt2">—</span></p>
      </div>
    </section>

    <!-- BOTTOM BANNER AD -->
    <div id="ad-bottom" class="relative ad-banner" data-size="banner" role="complementary" aria-label="Advertisement">
      <span class="ad-label">Ad</span>
      <div id="ad-bottom-slot" class="py-6 text-xs sm:text-sm">Banner Ad (320×100 / 728×90 / 970×90)</div>
    </div>
  </main>

  <!-- Bottom quick nav (mobile) -->
  <nav class="fixed bottom-3 left-1/2 -translate-x-1/2 z-40 md:hidden">
    <div class="tabs">
      <button class="tab active" data-go="today">আজ</button>
      <button class="tab" data-go="old">পুরাতন</button>
      <button class="tab" data-go="new">নতুন</button>
    </div>
  </nav>

  <!-- Firebase + App Code -->
  <script type="module">
    // Firebase config (replace)
    const firebaseConfig = { apiKey:"YOUR_API_KEY",authDomain:"YOUR_PROJECT_ID.firebaseapp.com",projectId:"YOUR_PROJECT_ID",storageBucket:"YOUR_PROJECT_ID.appspot.com",messagingSenderId:"YOUR_SENDER_ID",appId:"YOUR_APP_ID" };
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, onSnapshot, doc, onSnapshot as onDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    const app = initializeApp(firebaseConfig); const db = getFirestore(app);

    const moneyFmt = new Intl.NumberFormat('bn-BD',{ style:'currency', currency:'BDT', maximumFractionDigits:0 });
    function setLiveBadge(el,ok){ if(!el) return; el.textContent=ok?'Live':'Error'; el.className='text-xs px-2 py-1 rounded-full '+(ok?'bg-green-200 text-green-900':'bg-red-200 text-red-900'); }
    function setUpdated(el,ts){ try{ const d=ts?.toDate?ts.toDate():(ts instanceof Date?ts:null); el.textContent=d?d.toLocaleString('bn-BD',{hour12:false}):'—'; }catch{ el.textContent='—'; } }

    const status1=document.getElementById('status1');
    const status2=document.getElementById('status2');
    const updatedAt1=document.getElementById('updatedAt1');
    const updatedAt2=document.getElementById('updatedAt2');
    const updatedAtOld=document.getElementById('updatedAtOld');
    const updatedAtTop=document.getElementById('updatedAtTop');

    const els=Array.from(document.querySelectorAll('[data-key]')).reduce((acc,span)=>{acc[span.dataset.key]=span;return acc;},{});

    onSnapshot(collection(db,'prices'),(snap)=>{
      setLiveBadge(status1,true); setLiveBadge(status2,true);
      snap.docs.forEach(d=>{
        const data=d.data()||{}; const key=data.key||d.id; const el=els[key];
        if(el && typeof data.price==='number'){
          const prev=el.getAttribute('data-prev');
          const next=moneyFmt.format(data.price).replace('৳\u00A0','৳');
          if(prev!==next){ el.textContent=next; el.setAttribute('data-prev',next); const td=el.closest('td'); if(td){ td.classList.add('flash'); setTimeout(()=>td.classList.remove('flash'),700); } }
        }
      });
    },()=>{ setLiveBadge(status1,false); setLiveBadge(status2,false); });

    onDoc(doc(db,'meta','site'),(d)=>{ const data=d.data(); [updatedAt1,updatedAt2,updatedAtOld,updatedAtTop].forEach(el=>el&&setUpdated(el,data?.updatedAt)); });

    // UI toggles
    document.getElementById('themeToggle')?.addEventListener('click',()=>{ document.documentElement.classList.toggle('dark'); });
    let compact=false; document.getElementById('densityToggle')?.addEventListener('click',()=>{
      compact=!compact; document.querySelectorAll('table.rtable td, table.rtable th').forEach(el=>{ el.classList.toggle('py-2',compact); el.classList.toggle('py-3',!compact); });
    });

    // Tabs (mobile + hero)
    function setView(view){ document.body.setAttribute('data-view',view); document.querySelectorAll('.tab').forEach(b=>b.classList.toggle('active',b.dataset.go===view)); }
    document.querySelectorAll('.tab').forEach(btn=>btn.addEventListener('click',()=> setView(btn.dataset.go)));

    // Placeholder ads
    function mountPlaceholder(id){ const c=document.getElementById(id); if(!c) return; const w=c.clientWidth; const text=w>=970?'970×90':(w>=728?'728×90':'320×100'); c.querySelector('div').textContent='Banner Ad ('+text+')'; }
    ['ad-top','ad-mid','ad-bottom'].forEach(mountPlaceholder);
    window.addEventListener('resize',()=>['ad-top','ad-mid','ad-bottom'].forEach(mountPlaceholder));
  </script>
</body>
</html>
